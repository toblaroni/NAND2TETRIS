
class Cell {
    field boolean alive;
    field int x, y, size;

    static Cell cell;

    constructor Cell new(int x_, int y_, int size_, boolean alive_) {
        let x = x_;
        let y = y_;
        let size = size_;
        let alive = alive_;

        return this;
    }

    method void draw() {
        if (is_alive()) {
            do Screen.setColor(true); // Set black
        } else {
            do Screen.setColor(false);
        }

        do Screen.drawRectangle(x, y, x + size, y + size);
        return;
    }

    method boolean is_alive() {
        return alive;
    }

    method void kill() {
        let alive = false;
        return;
    }

    method void bring_alive() {
        let alive = true;
        return;
    }

    method int num_neighbours(GameOfLife board) {
        /*
            board is the 2D board array
                +----+-----+----+
                | NW |  N  | NE |
                +----+-----+----+
                | W  |  C  | E  |       # C is 'this'
                +----+-----+----+
                | SW |  S  | SE |
                +----+-----+----+
        */

        do Output.printInt(board.get_height());
        do Output.println();
        do Output.printInt(board.get_width());

        return NW(board) + N(board) +
               NE(board) + E(board) + 
               SE(board) + S(board) + 
               SW(board) + W(board);
    }

    method int NW(GameOfLife board) {
        if (x = 0 | y = 0) {  return 0; } 

        let cell = GameOfLife.get_cell(x-1, y-1, board);
        return cell.is_alive_int();
    }

    method int N(GameOfLife board) {
        if (y = 0) { return 0; } 

        let cell = GameOfLife.get_cell(x, y-1, board);
        return cell.is_alive_int();
    }

    method int NE(GameOfLife board) {
        if (y = 0 | x = board.get_width()-1) { return 0; } 

        let cell = GameOfLife.get_cell(x+1, y-1, board);
        return cell.is_alive_int();
    }

    method int E(GameOfLife board) {
        if (x = board.get_width()-1) { return 0; } 

        let cell = GameOfLife.get_cell(x+1, y, board);
        return cell.is_alive_int();
    }

    method int SE(GameOfLife board) {
        if (y = board.get_height()-1 | x = board.get_width()-1) { return 0; } 

        let cell = GameOfLife.get_cell(x+1, y+1, board);
        return cell.is_alive_int();
    }
    
    method int S(GameOfLife board) {
        if (y = board.get_height()-1) { return 0; } 

        let cell = GameOfLife.get_cell(x, y+1, board);
        return cell.is_alive_int();
    }
    
    method int SW(GameOfLife board) {
        if (y = board.get_height()-1 | x = 0) { return 0; } 

        let cell = GameOfLife.get_cell(x-1, y+1, board);
        return cell.is_alive_int();
    }
    
    method int W(GameOfLife board) {
        if (x = 0) { return 0; } 

        let cell = GameOfLife.get_cell(x-1, y, board);
        return cell.is_alive_int();
    }

    method int is_alive_int() {
        if (alive) {
            return 1;
        } else {
            return 0;
        }
    }

    method void dispose() {
        do Memory.deAlloc(this);
        return;
    }
}